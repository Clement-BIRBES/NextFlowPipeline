#!/usr/bin/env python

import argparse
from Bio import SeqIO
import os
import os.path
from os import path
import glob


parser = argparse.ArgumentParser(description='Description of your program')
parser.add_argument('--length', help = "chunck length", required=True)
args = vars(parser.parse_args())

chunck = args['length']

y=1
x=1

ListFile=[f for f in os.listdir('.')]
NumberFiles=len(ListFile)


while (x < NumberFiles):
	y=1
	if (path.exists("pilonSRctg"+str(x)+".fasta")):
		x+=1
	else:
		NumberFiles+=1
		with open("pilonSRctg"+str(x)+".fasta","a") as a1:
			while (glob.glob("pilonSRctg"+str(x)+":"+str(y)+"-*.fasta")):
				NumberFiles-=1
				for seq_record in SeqIO.parse(glob.glob("pilonSRctg"+str(x)+":"+str(y)+"-*.fasta")[0],"fasta"):
					a1.write(seq_record.seq)
					y+=int(chunck)
			a1.close()
			x+=1

for x in range(1, NumberFiles):
	if (path.exists("pilonSRctg"+str(x)+".fasta")):
		for seq_record in SeqIO.parse("pilonSRctg"+str(x)+".fasta", "fasta"):
			LenFile=len(seq_record)
			with open("pilonOut.fa","a") as f1:
				if(LenFile > 0):
					f1.write("\n>ctg"+str(x)+" len="+str(LenFile)+"\n")
					f1.write(seq_record.seq)
			f1.close()

cmd = "sed -i '1d' pilonOut.fa"
os.system(cmd)
